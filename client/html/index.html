<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Server in the browser</title>
        <link rel="stylesheet" href="css">
        <meta name="viewport" content="width=device-width">
        <link rel="icon" href="favicon.png">
    </head>
    <body>
        <header>
            <h1>Server in the browser <span class="titleversion">alpha</span></h1>
            <nav>
                <ul>
                    <li><a href="/about">About</a></li>
                    <li><a href="/help">Help</a></li>
                    <li><a href="/open_source">Open Source</a></li>
                    <li><a href="https://github.com/GrosSacASac/server-in-the-browser/">GitHub</a></li>
                </ul>
            </nav>
        </header>
        
        <noscript>
            <p>JavaScript must be enabled to use Server in the browser</p>
        </noscript>
        <p id="starterror">There was an error in the program, please download the latest <a target="_blank" href="https://www.mozilla.org/en-US/firefox/new/?scene=2">firefox or chrome version</a>.</p>
        <p id="requirementerror"></p>
        <p data-fx="click-debug"><span data-vr="log" id="log"></span></p>
        
        <div hidden class="dialog">
            <p data-vr="answerYesNoQuestionText"></p>
            <button data-vr="answerYesNoYesText" data-el="answerYesNoYesElement" data-fx="click-answerYesNo"></button>
            <button data-vr="answerYesNoNoText" data-fx="click-answerYesNo"></button>
        </div>

        <section hidden data-el="landingPage">
            <h2>Please read</h2>
            <p>To use Server in the browser you must understand and accept the following : Server in the browser will store data in the consistent storage system of the computer and install a background script called service worker that will run in the background.</p>
            <button data-fx="click-acceptAndStart">Accept</button>
        </section>
        
        <main hidden data-el="main"> 
            <details open="open">
                <summary>Connections</summary>
                <section data-el="generalInformation">
                    <h2>Your id: <span data-vr="your_id"></span></h2>
                    <h3>Connected users</h3>
                    <template data-el="userItemTemplate-user-item">
                        <span data-vr="userDisplayName"></span>
                        <button data-vr="connectButton" data-el="connectButton" data-fx="click-connectToUser">Connect and select</button>
                        <button hidden data-vr="selectButton" data-el="selectButton" data-fx="click-selectUser">Select</button>
                        <button hidden>future addition</button>
                    </template>
                    <ul data-el="connected_users" class="userlist"></ul>
                    <p><a data-el="indexLink" class="disabled" target="_blank" href="rtc/">Visit selected index</a></p>
                </section>
            </details>

            <details>
                <summary>Chat</summary>
                <section data-el="chat">
                    <div>
                        <h3>Message Received</h3>
                        <div data-el="allButLastMessages"></div>
                        <p data-vr="lastMessage"></p>
                    </div>
                    <div>
                        <textarea data-el="input" data-vr="input" placeholder="Click on a user, enter some text, then press Send Message." rows="4" cols="50"></textarea>
                        <button data-fx="click-sendMessage" data-el="send_button">Send Chat Message</button>
                    </div>
                </section>
            </details>

            <details >
                <summary >Server</summary>
                <section data-el="server">
                    <template data-el="fileInputTemplate-file-input">
                        <label>Filename
                            <input data-fx="rememberFileName" data-vr="fileName">
                        </label>
                        <textarea data-vr="fileBody" data-el="fileBody" rows="2" cols="22"></textarea>
                        <label>MIME:
                            <input data-vr="fileMime" data-el="fileMime" placeholder="leave blank for guess with file extension">
                        </label>
                        <button data-fx="click-removeRessource">[X]</button>
                    </template>
                    <label>Make local server available<input data-fx="changeLocalServerAvailability" data-vr="localServerAvailability" type="checkbox"></label>
                    <div data-el="readFilesContainer"></div>
                    <button data-fx="click-addRessource">Load from file</button>
                    <button data-fx="click-addRessourceEmpty">Add blank ressource</button>
                    <button data-fx="click-generateIndex">Generate Index</button>
                    <div>
                        <h2>Ressources Offered</h2>
                        <progress data-el="fileProgress" hidden></progress>
                        <div data-el="ressourcesContainer"></div>
                    </div>

                    <div data-el="serverprogram">
                        <h2>serverprogram</h2>
                        <div>
                            <label>Use a node.js program to handle requests<input data-fx="useCustom" data-vr="useCustom" data-el="useCustom" type="checkbox"></label>
                            <p data-el="parsingResult" data-vr="parsingResult"></p>
                            <a href="/example.zip" target="_blank" download="node_example.zip">Download example</a>
                        </div>
                        <label>
                            <textarea 
                                data-fx="changeCustom" data-vr="userCode"
                                rows="25" cols="60" maxlength="10000000" dir="ltr"
                                autocomplete="off" spellcheck="false"
                                placeholder="Function to be executed to handle incoming messages"
                            ></textarea>
                        </label>
                    </div>
                </section>
            </details>
            <details>
                <summary>Settings</summary>
                <section data-el="settings">
                    <div>
                        <label>Change your ID: <input data-vr="newId" data-el="newId" type="text" min="4" max="25" pattern="[a-zA-Z0-9]+" title="An ID is 4 to 25 characters long, and only etters from a to Z and digits from 0 to 9  are allowed"></label><button data-fx="click-idChangeRequest"  data-el="idChangeRequestButton">Request ID change</button><p data-vr="idChangeFeedback"></p>
                    </div>
                    <div>
                        <button data-fx="click-deleteAll">Delete all data and quit</button>
                    </div>
                </section>
            </details>
        </main>
        
        <p><!--Server log --><span data-vr="serverLog"></span></p>
        <template data-el="missingFeatureTemplate-missing-feature">
            <section>
                <h3 data-vr="title"></h3>
                <p data-vr="text"></p><p>To enable this feature, install the latest update for the browser and see</p>
                <ul data-list="links-a"></ul>
            </section>
        </template>
        <article data-el="missingFeatures"></article>
        <script src="app"></script>
    </body>
</html>
